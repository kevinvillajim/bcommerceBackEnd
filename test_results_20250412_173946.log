Iniciando pruebas del sistema BCommerce a 2025-04-12 17:39:46
===============================================
Ejecutando todas las pruebas unitarias...
Ejecutando: php artisan test tests/Unit

   PASS  Tests\Unit\ChatFilterServiceTest
  ✓ it detects phone numbers                                             0.85s
  ✓ it detects number emojis                                             0.03s
  ✓ it registers strike for prohibited content                           0.03s
  ✓ it blocks seller after strike limit                                  0.10s
  ✓ it censors prohibited content                                        0.15s
  ✓ it provides correct reject reason                                    0.05s

   PASS  Tests\Unit\ComplexRecommendationSystemTest
  ✓ it handles complete recommendation workflow                          0.44s

   PASS  Tests\Unit\Domain\Entities\CategoryEntityTest
  ✓ it can be instantiated                                               0.03s
  ✓ it can be created from static method
  ✓ it can be reconstituted
  ✓ it updates timestamp when modified                                   1.03s
  ✓ it can add child categories                                          0.02s
  ✓ it can activate and deactivate
  ✓ it can be featured and unfeatured
  ✓ it can convert to array

   FAIL  Tests\Unit\Domain\Entities\ProductEntityTest
  ⨯ it can be instantiated                                               0.23s
  ⨯ it can calculate final price with discount
  ⨯ it can determine if in stock
  ⨯ it can decrement stock
  ⨯ it can increment view count
  ⨯ it can increment sales count
  ⨯ it can convert to array

   PASS  Tests\Unit\Infrastructure\Repositories\EloquentCategoryRepositoryTest
  ✓ it can find a category by id                                         0.03s
  ✓ it returns null when category not found                              0.03s
  ✓ it can find a category by slug                                       0.03s
  ✓ it can find all categories                                           0.03s
  ✓ it can find featured categories                                      0.03s
  ✓ it can find main categories                                          0.03s
  ✓ it can find subcategories                                            0.03s
  ✓ it can save a new category                                           0.06s
  ✓ it can update an existing category                                   0.03s
  ✓ it can delete a category                                             0.04s
  ✓ it can count categories                                              0.03s
  ✓ it can create from array                                             0.03s
  ✓ it can update from array                                             0.04s

   FAIL  Tests\Unit\Infrastructure\Repositories\EloquentProductRepositoryTest
  ⨯ it can create a product                                              0.06s
  ✓ it can find a product by id                                          0.04s
  ✓ it returns null when product not found                               0.03s
  ✓ it can find a product by slug                                        0.04s
  ✓ it can update a product                                              0.05s
  ✓ it dispatches events when updating product                           0.04s
  ✓ it can delete a product                                              0.07s
  ✓ it can increment view count                                          0.04s
  ✓ it can update stock                                                  0.08s
  ✓ it can find products by category                                     0.04s
  ✓ it can search products                                               0.09s
  ✓ it can find featured products                                        0.04s
  ✓ it can find products by tags                                         0.04s
  ✓ it can find popular products                                         0.04s

   PASS  Tests\Unit\Middleware\JwtMiddlewareTest
  ✓ it rejects request from blocked user                                 0.05s
  ✓ it allows request from non blocked user                              0.03s

   PASS  Tests\Unit\RecommendationServiceTest
  ✓ it tracks user interaction                                           0.03s
  ✓ it gets user profile                                                 0.03s
  ✓ it generates recommendations based on preferences                    0.03s
  ✓ it generates demographic profile                                     0.03s
  ✓ it enriches profile with demographic data when needed                0.03s

   PASS  Tests\Unit\SellerModelTest
  ✓ it belongs to a user                                                 0.04s
  ✓ it can calculate average rating                                      0.04s
  ✓ it calculates trustworthiness score                                  0.06s
  ✓ it becomes inactive when user is blocked                             0.04s

   PASS  Tests\Unit\SellerRepositoryTest
  ✓ it can find seller by id                                             0.04s
  ✓ it can find seller by user id                                        0.03s
  ✓ it returns null for nonexistent seller                               0.03s
  ✓ it can create a seller                                               0.03s
  ✓ it can update a seller                                               0.03s
  ✓ it can get top sellers by rating                                     0.05s
  ✓ it can get featured sellers                                          0.04s

   FAIL  Tests\Unit\Services\JwtServiceTest
  ✓ it can generate token                                                0.07s
  ✓ it can get user from token                                           0.08s
  ✓ it can validate token                                                0.03s
  ✓ it returns false for invalid token                                   0.09s
  ⨯ it can refresh token                                                 0.04s
  ✓ it can invalidate token                                              0.07s

   WARN  Tests\Unit\Services\RecommendationServiceTest
  ✓ it tracks user interaction                                           0.04s
  ✓ it gets user profile                                                 0.03s
  ✓ it gets formatted user profile                                       0.04s
  ✓ it calls track user interaction from alias method                    0.03s
  ✓ it generates demographic profile                                     0.03s
  - it generates recommendations with empty profile → Esta prueba neces… 0.07s

   PASS  Tests\Unit\ShoppingCartEntityTest
  ✓ it creates cart with default values                                  0.03s
  ✓ it adds new item                                                     0.03s
  ✓ it updates quantity when adding existing product                     0.03s
  ✓ it removes item                                                      0.03s
  ✓ it updates item quantity                                             0.03s
  ✓ it empties cart                                                      0.03s

   PASS  Tests\Unit\ShoppingCartRepositoryTest
  ✓ it creates a shopping cart                                           0.04s
  ✓ it adds item to cart                                                 0.04s
  ✓ it removes item from cart                                            0.04s
  ✓ it updates item quantity                                             0.04s
  ✓ it finds cart by user id                                             0.04s
  ✓ it clears cart                                                       0.04s

   PASS  Tests\Unit\UseCases\Accounting\CancelInvoiceUseCaseTest
  ✓ it cancels invoice and creates reverse transaction                   0.04s
  ✓ it throws exception if invoice not found                             0.05s
  ✓ it throws exception if invoice already cancelled                     0.03s
  ✓ it returns false if sri cancellation fails                           0.03s

   PASS  Tests\Unit\UseCases\Accounting\GenerateAccountingReportUseCaseTest
  ✓ it generates balance sheet report                                    0.03s
  ✓ it generates income statement report                                 0.03s
  ✓ it generates account ledger report                                   0.03s

   PASS  Tests\Unit\UseCases\Accounting\GenerateInvoiceUseCaseSpecialCasesTest
  ✓ it handles order with multiple items                                 0.04s
  ✓ it handles failed sri generation                                     0.03s
  ✓ it handles zero tax orders                                           0.03s

   PASS  Tests\Unit\UseCases\Accounting\GenerateInvoiceUseCaseTest
  ✓ it returns existing invoice if already generated                     0.03s
  ✓ it generates new invoice with accounting transaction                 0.03s
  ✓ it throws exception when order not found                             0.03s

   PASS  Tests\Unit\UseCases\Cart\AddItemToCartUseCaseTest
  ✓ it adds product to existing cart                                     0.03s
  ✓ it creates cart if not exists                                        0.03s
  ✓ it throws exception if product not found                             0.03s
  ✓ it throws exception if insufficient stock                            0.03s

   PASS  Tests\Unit\UseCases\Chat\CreateChatUseCaseTest
  ✓ it creates a chat

   PASS  Tests\Unit\UseCases\Chat\SendMessageUseCaseTest
  ✓ it sends a valid message                                             0.02s
  ✓ it rejects prohibited content

   PASS  Tests\Unit\UseCases\Checkout\ProcessCheckoutUseCaseTest
  ✓ it processes checkout successfully                                   0.03s
  ✓ it throws exception if cart is empty                                 0.03s
  ✓ it throws exception if payment fails                                 0.05s

   FAIL  Tests\Unit\UseCases\Feedback\DiscountCodeUseCaseTest
  ✓ generate discount code use case                                      0.03s
  ⨯ apply discount code use case                                         0.11s
  ✓ invalid discount code returns error                                  0.03s
  ✓ expired discount code returns error                                  0.03s

   PASS  Tests\Unit\UseCases\Product\CreateProductUseCaseTest
  ✓ it creates a product with basic data                                 0.05s

   PASS  Tests\Unit\UseCases\Product\SearchProductsUseCaseTest
  ✓ it searches products with term                                       0.05s
  ✓ it searches products with filters                                    0.03s
  ✓ it searches products by category                                     0.03s
  ✓ it searches products by tags                                         0.03s

   PASS  Tests\Unit\UseCases\Recommendation\GenerateRecommendationsUseCaseTest
  ✓ it executes and returns recommendations                              0.03s

   PASS  Tests\Unit\UseCases\Recommendation\GetUserProfileUseCaseTest
  ✓ it executes and formats user profile                                 0.03s

   WARN  Tests\Unit\UseCases\Recommendation\TrackUserInteractionsUseCaseTest
  ! it tracks user interaction → This test did not perform any assertio… 0.03s

   FAIL  Tests\Unit\UseCases\User\LoginUserUseCaseTest
  ⨯ it returns token for valid credentials                               0.10s
  ⨯ it returns null for invalid credentials                              0.25s
  ⨯ it returns error for blocked user                                    0.04s

   PASS  Tests\Unit\UserProfileRepositoryTest
  ✓ it saves user interaction                                            0.04s
  ✓ it retrieves user interactions                                       0.04s
  ✓ it builds user profile                                               0.04s
  ✓ it gets category preferences                                         0.05s
  ✓ it gets recent search terms                                          0.04s
  ✓ it gets viewed products                                              0.09s
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Domain\Entities\ProductEntityTest > it can…   TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #12 ($height) must be of type ?float, string given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\Domain\Entities\ProductEntityTest.php on line 14

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\Domain\Entities\ProductEntityTest.php:14

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Domain\Entities\ProductEntityTest > it can…   TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #8 ($price) must be of type float, null given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\Domain\Entities\ProductEntityTest.php on line 51

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\Domain\Entities\ProductEntityTest.php:51

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Domain\Entities\ProductEntityTest > it can…   TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #8 ($price) must be of type float, null given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\Domain\Entities\ProductEntityTest.php on line 85

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\Domain\Entities\ProductEntityTest.php:85

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Domain\Entities\ProductEntityTest > it can…   TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #8 ($price) must be of type float, null given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\Domain\Entities\ProductEntityTest.php on line 147

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\Domain\Entities\ProductEntityTest.php:147

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Domain\Entities\ProductEntityTest > it can…   TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #8 ($price) must be of type float, null given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\Domain\Entities\ProductEntityTest.php on line 186

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\Domain\Entities\ProductEntityTest.php:186

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Domain\Entities\ProductEntityTest > it can…   TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #8 ($price) must be of type float, null given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\Domain\Entities\ProductEntityTest.php on line 220

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\Domain\Entities\ProductEntityTest.php:220

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Domain\Entities\ProductEntityTest > it can…   TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #8 ($price) must be of type float, null given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\Domain\Entities\ProductEntityTest.php on line 254

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\Domain\Entities\ProductEntityTest.php:254

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Infrastructure\Repositories\EloquentProduct…  TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #8 ($price) must be of type float, null given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\Infrastructure\Repositories\EloquentProductRepositoryTest.php on line 36

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\Infrastructure\Repositories\EloquentProductRepositoryTest.php:36

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Services\JwtServiceTest > it can refre…  ErrorException
  array_flip(): Can only flip string and integer values, entry skipped

  at vendor\laravel\framework\src\Illuminate\Collections\Arr.php:516
    512▕      * @return array
    513▕      */
    514▕     public static function only($array, $keys)
    515▕     {
  ➜ 516▕         return array_intersect_key($array, array_flip((array) $keys));
    517▕     }
    518▕
    519▕     /**
    520▕      * Select an array of values from an array.

  1   vendor\laravel\framework\src\Illuminate\Collections\Collection.php:958
  2   vendor\tymon\jwt-auth\src\Manager.php:168

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\UseCases\Feedback\DiscountCodeUseCaseTest >…  TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #8 ($price) must be of type float, null given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Unit\UseCases\Feedback\DiscountCodeUseCaseTest.php on line 115

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Unit\UseCases\Feedback\DiscountCodeUseCaseTest.php:115

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\UseCases\User\LoginUserUseCaseTest > it returns token…
  Failed asserting that an array has the key 'access_token'.

  at tests\Unit\UseCases\User\LoginUserUseCaseTest.php:63
     59▕         ]);
     60▕
     61▕         // Assert - check the result
     62▕         $this->assertIsArray($result);
  ➜  63▕         $this->assertArrayHasKey('access_token', $result);
     64▕         $this->assertEquals('valid-token', $result['access_token']);
     65▕         $this->assertArrayHasKey('token_type', $result);
     66▕         $this->assertArrayHasKey('expires_in', $result);
     67▕         $this->assertArrayHasKey('user', $result);

  1   tests\Unit\UseCases\User\LoginUserUseCaseTest.php:63

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\UseCases\User\LoginUserUseCaseTest > it returns null f…
  Failed asserting that Array &0 [
    'error' => 'Correo o contraseña incorrectos.',
] is null.

  at tests\Unit\UseCases\User\LoginUserUseCaseTest.php:80
     76▕             'password' => 'wrong-password',
     77▕         ]);
     78▕
     79▕         // Assert - should return null for invalid credentials
  ➜  80▕         $this->assertNull($result);
     81▕     }
     82▕
     83▕     #[Test]
     84▕     public function it_returns_error_for_blocked_user()

  1   tests\Unit\UseCases\User\LoginUserUseCaseTest.php:80

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\UseCases\User\LoginUserUseCaseTest > it returns error…
  Expected: Tu cuenta ha sido bloqueada. Por favor, contacta con soporte.

  To contain: blocked

  at tests\Unit\UseCases\User\LoginUserUseCaseTest.php:98
     94▕
     95▕         // Assert - check the error result
     96▕         $this->assertIsArray($result);
     97▕         $this->assertArrayHasKey('error', $result);
  ➜  98▕         $this->assertStringContainsString('blocked', $result['error']);
     99▕     }
    100▕ }
    101▕

  1   tests\Unit\UseCases\User\LoginUserUseCaseTest.php:98


  Tests:    13 failed, 1 risky, 1 skipped, 120 passed (456 assertions)
  Duration: 8.19s

===============================================
⚠️ WARNING: El comando anterior falló con código de salida 2
Ejecutando pruebas de servicios...
Ejecutando: php artisan test tests/Unit/Services

   FAIL  Tests\Unit\Services\JwtServiceTest
  ✓ it can generate token                                                0.75s
  ✓ it can get user from token                                           0.04s
  ✓ it can validate token                                                0.03s
  ✓ it returns false for invalid token                                   0.03s
  ⨯ it can refresh token                                                 0.05s
  ✓ it can invalidate token                                              0.04s

   WARN  Tests\Unit\Services\RecommendationServiceTest
  ✓ it tracks user interaction                                           0.05s
  ✓ it gets user profile                                                 0.03s
  ✓ it gets formatted user profile                                       0.03s
  ✓ it calls track user interaction from alias method                    0.03s
  ✓ it generates demographic profile                                     0.03s
  - it generates recommendations with empty profile → Esta prueba neces… 0.03s
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Unit\Services\JwtServiceTest > it can refre…  ErrorException
  array_flip(): Can only flip string and integer values, entry skipped

  at vendor\laravel\framework\src\Illuminate\Collections\Arr.php:516
    512▕      * @return array
    513▕      */
    514▕     public static function only($array, $keys)
    515▕     {
  ➜ 516▕         return array_intersect_key($array, array_flip((array) $keys));
    517▕     }
    518▕
    519▕     /**
    520▕      * Select an array of values from an array.

  1   vendor\laravel\framework\src\Illuminate\Collections\Collection.php:958
  2   vendor\tymon\jwt-auth\src\Manager.php:168


  Tests:    1 failed, 1 skipped, 10 passed (25 assertions)
  Duration: 1.34s

===============================================
⚠️ WARNING: El comando anterior falló con código de salida 2
Ejecutando prueba del servicio de recomendación...
Ejecutando: php artisan test tests/Unit/Services/RecommendationServiceTest.php

   WARN  Tests\Unit\Services\RecommendationServiceTest
  ✓ it tracks user interaction                                           0.74s
  ✓ it gets user profile                                                 0.03s
  ✓ it gets formatted user profile                                       0.03s
  ✓ it calls track user interaction from alias method                    0.03s
  ✓ it generates demographic profile                                     0.03s
  - it generates recommendations with empty profile → Esta prueba neces… 0.04s

  Tests:    1 skipped, 5 passed (17 assertions)
  Duration: 1.08s

===============================================
Ejecutando pruebas de casos de uso de recomendación...
Ejecutando: php artisan test tests/Unit/UseCases/Recommendation

   PASS  Tests\Unit\UseCases\Recommendation\GenerateRecommendationsUseCaseTest
  ✓ it executes and returns recommendations                              0.70s

   PASS  Tests\Unit\UseCases\Recommendation\GetUserProfileUseCaseTest
  ✓ it executes and formats user profile                                 0.03s

   WARN  Tests\Unit\UseCases\Recommendation\TrackUserInteractionsUseCaseTest
  ! it tracks user interaction → This test did not perform any assertio… 0.04s

  Tests:    1 risky, 2 passed (8 assertions)
  Duration: 0.96s

===============================================
Ejecutando pruebas de middleware...
Ejecutando: php artisan test tests/Unit/Middleware

   PASS  Tests\Unit\Middleware\JwtMiddlewareTest
  ✓ it rejects request from blocked user                                 0.73s
  ✓ it allows request from non blocked user                              0.03s

  Tests:    2 passed (8 assertions)
  Duration: 0.94s

===============================================
Ejecutando pruebas de característica...
Ejecutando: php artisan test tests/Feature

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_view_their_orders(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_filter_orders_by_status(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_update_order_status(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_cannot_update_another_sellers_order(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_complete_an_order(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_view_order_stats(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_update_shipping_info(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_cancel_order(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::user_cannot_access_seller_endpoints(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_view_orders_awaiting_shipment(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   WARN  Metadata found in doc-comment for method Tests\Feature\OrderControllerTest::seller_can_view_order_details(). Metadata in doc-comments is deprecated and will no longer be supported in PHPUnit 12. Update your test code to use attributes instead.

   PASS  Tests\Feature\AdicionalChatRepositoryTest
  ✓ it gets chat by id                                                   0.77s
  ✓ it returns null when chat not found                                  0.03s
  ✓ it gets chats by user id                                             0.04s
  ✓ it gets chats by seller id                                           0.04s
  ✓ it gets messages with pagination                                     0.04s
  ✓ it updates chat timestamp when adding message                        1.05s
  ✓ it handles empty message list                                        0.04s
  ✓ it returns empty array for nonexistent chats                         0.03s

   PASS  Tests\Feature\AdminNotificationTest
  ✓ it notifies admin of new feedback                                    0.05s
  ✓ it notifies admin of seller strike                                   0.04s
  ✓ it notifies admin of low rating                                      0.05s
  ✓ it notifies admin of seller rank change                              0.05s
  ✓ it notifies admin of shipping delay                                  0.04s
  ✓ it notifies admin of out of stock product                            0.04s
  ✓ it blocks seller and notifies admin after three strikes              0.06s
  ✓ it can mark admin notifications as read                              0.04s
  ✓ it can test admin api endpoints                                      0.14s
  ✓ it sends daily sales notifications to admins                         0.04s

   PASS  Tests\Feature\AdminTest
  ✓ it allows admins to view dashboard                                   0.05s
  ✓ it prevents regular users from accessing admin routes                0.04s
  ✓ it allows admins to list sellers                                     0.12s
  ✓ it allows admins to update seller status                             0.06s
  ✓ it allows admins to create sellers                                   0.05s
  ✓ it allows admins to update seller details                            0.05s
  ✓ it allows admins to moderate ratings                                 0.05s
  ✓ it allows admins to list pending ratings                             0.06s
  ✓ it allows super admin to add new admin                               0.05s
  ✓ it prevents non super admin from managing admins                     0.04s
  ✓ it allows super admin to remove admin                                0.05s
  ✓ it prevents removing super admin by regular admin                    0.04s
  ✓ it allows super admin to list all admins                             0.05s

   FAIL  Tests\Feature\AuthTest
  ✓ it can login with valid credentials                                  0.05s
  ⨯ it cannot login with invalid credentials                             0.18s
  ✓ it cannot access protected routes without token                      0.04s
  ✓ it can get authenticated user with token                             0.05s
  ⨯ it can refresh token                                                 0.12s
  ✓ it can logout                                                        0.04s
  ⨯ it blocks access for blocked user                                    0.04s

   FAIL  Tests\Feature\Auth\AuthControllerTest
  ✓ user can login successfully                                          0.04s
  ⨯ user cannot login with invalid credentials                           0.04s
  ⨯ blocked user cannot login                                            0.04s
  ✓ authenticated user can get profile                                   0.04s
  ✓ authenticated user can logout                                        0.04s
  ⨯ authenticated user can refresh token                                 0.04s

   PASS  Tests\Feature\Auth\EmailVerificationTest
  ✓ email can be verified                                                0.16s
  ✓ email is not verified with invalid hash                              0.06s

   PASS  Tests\Feature\Auth\PasswordResetTest
  ✓ reset password link generates token                                  0.05s
  ✓ can reset password with valid token                                  0.05s
  ✓ cannot reset password with invalid token                             0.04s
  ✓ token validation works correctly                                     0.04s

   PASS  Tests\Feature\Auth\RegistrationTest
  ✓ new users can register                                               0.06s

   PASS  Tests\Feature\CategoryTest
  ✓ admin can create a category                                          0.11s
  ✓ regular user cannot create category                                  0.04s
  ✓ admin can update a category                                          0.05s
  ✓ admin can delete a category without products or subcategories        0.04s
  ✓ cannot delete category with products                                 0.05s
  ✓ guests can view categories                                           0.04s
  ✓ guests can view category details                                     0.04s
  ✓ guests can view category by slug                                     0.04s
  ✓ guests can view main categories                                      0.04s
  ✓ guests can view subcategories                                        0.04s

   PASS  Tests\Feature\ChatRepositoryTest
  ✓ it creates a chat                                                    0.04s
  ✓ it adds a message to chat                                            0.04s
  ✓ it retrieves messages for chat                                       0.04s
  ✓ it marks messages as read                                            0.06s

   PASS  Tests\Feature\FavoriteTest
  ✓ user can toggle favorite status                                      0.07s
  ✓ user can retrieve favorites                                          0.05s
  ✓ user can check if product is favorited                               0.05s
  ✓ user can update notification preferences                             0.05s
  ✓ user receives notification when favorited product price changes      0.04s
  ✓ user receives notification when favorited product stock is low       0.04s

   PASS  Tests\Feature\FeedbackControllerTest
  ✓ user can create feedback                                             0.05s
  ✓ user can view their own feedback                                     0.05s
  ✓ user cannot view other user feedback                                 0.04s
  ✓ admin can view all feedback                                          0.05s
  ✓ seller created with seller id in feedback                            0.06s
  ✓ feedback validation                                                  0.09s

   PASS  Tests\Feature\FeedbackSystemTest
  ✓ complete user feedback and discount flow                             0.09s
  ✓ seller feedback flow                                                 0.06s
  ✓ admin can view pending feedbacks                                     0.05s
  ✓ user cannot review feedback                                          0.05s

   FAIL  Tests\Feature\OrderControllerTest
  ⨯ seller can view their orders                                         0.05s
  ⨯ seller can filter orders by status                                   0.06s
  ⨯ seller can update order status                                       0.05s
  ⨯ seller cannot update another sellers order                           0.05s
  ⨯ seller can complete an order                                         0.05s
  ⨯ seller can view order stats                                          0.05s
  ⨯ seller can update shipping info                                      0.05s
  ⨯ seller can cancel order                                              0.05s
  ⨯ user cannot access seller endpoints                                  0.05s
  ⨯ seller can view orders awaiting shipment                             0.05s
  ⨯ seller can view order details                                        0.05s

   PASS  Tests\Feature\ProductControllerTest
  ✓ it lists products                                                    0.06s
  ✓ it shows product details                                             0.04s

   FAIL  Tests\Feature\ProductRepositoryTest
  ⨯ it creates a product                                                 0.05s
  ✓ it finds product by id                                               0.04s
  ✓ it finds product by slug                                             0.04s
  ✓ it updates a product                                                 0.05s
  ✓ it deletes a product                                                 0.04s
  ✓ it finds products by category                                        0.04s
  ✓ it searches products                                                 0.04s
  ✓ it finds products by tags                                            0.04s
  ✓ it increments view count                                             0.04s
  ✓ it updates stock                                                     0.04s

   FAIL  Tests\Feature\ProductSearchIntegrationTest
  ✓ it searches products by name                                         0.05s
  ✓ it searches products by description                                  0.04s
  ✓ it filters products by category                                      0.04s
  ✓ it combines search with category filter                              0.04s
  ⨯ it tracks search interaction                                         0.06s
  ⨯ it gets recommendations after search                                 0.05s

   FAIL  Tests\Feature\RatingSystemTest
  ✓ middleware configuration                                             0.04s
  ✓ it allows buyers to rate sellers                                     0.04s
  ✓ it allows buyers to rate products                                    0.04s
  ✓ it allows sellers to rate buyers                                     0.04s
  ✓ it prevents duplicate ratings                                        0.04s
  ✓ it retrieves ratings for seller                                      0.05s
  ✓ it retrieves ratings for product                                     0.04s
  ⨯ it retrieves user given ratings                                      0.05s
  ✓ it retrieves seller received ratings                                 0.05s

   FAIL  Tests\Feature\RecommendationSystemTest
  ✓ it tracks and retrieves user interactions                            0.04s
  ✓ it generates recommendations based on interactions                   0.05s
  ✓ it retrieves user profile with interests                             0.04s
  ⨯ it handles api calls for recommendations                             0.04s
  ⨯ it tracks api interactions                                           0.04s
  ⨯ it retrieves user profile via api                                    0.04s

   PASS  Tests\Feature\SellerNotificationTest
  ✓ it notifies seller of new message                                    0.05s
  ✓ it notifies seller of new order                                      0.04s
  ✓ it notifies seller of feedback response                              0.04s
  ✓ it notifies seller of low stock                                      0.04s
  ✓ it notifies seller of shipping delay                                 0.04s
  ✓ it notifies seller of strike                                         0.04s
  ✓ it notifies seller of account block                                  0.04s
  ✓ it notifies seller when rated by customer                            0.04s
  ✓ it blocks seller after three strikes                                 0.05s
  ✓ it can test api endpoints                                            0.05s

   PASS  Tests\Feature\SellerTest
  ✓ it allows admin to create sellers                                    0.05s
  ✓ it allows active sellers to access seller routes                     0.04s
  ✓ it prevents existing sellers from registering again                  0.05s
  ✓ it prevents non sellers from accessing seller routes                 0.04s
  ✓ it can get top sellers by rating                                     0.05s
  ✓ it updates seller status to inactive when user is blocked            0.04s
  ✓ it prevents admin from creating duplicate seller accounts            0.05s

   PASS  Tests\Feature\ShippingExternalUpdateTest
  ✓ it accepts external updates with valid api key                       0.05s
  ✓ it rejects external updates with invalid api key                     0.04s
  ✓ it rejects external updates with invalid status                      0.04s
  ✓ it rejects external updates to nonexistent shipping                  0.04s
  ✓ it rejects external updates to final state shipping                  0.04s
  ✓ it accepts update from delivered to returned                         0.05s

   FAIL  Tests\Feature\ShippingHistoryTest
  ⨯ it debugs shipping history entries                                   0.06s
  ✓ it checks shipping history model relationship                        0.05s
array(2) {
  ["tracking_number"]=>
  string(14) "TR472413002818"
  ["response"]=>
  string(68) "{"status":"error","message":"Forbidden: Seller privileges required"}"
}

   FAIL  Tests\Feature\ShippingTrackerTest
  ⨯ it can get shipping tracking info                                    0.05s
  ⨯ it can get shipping history                                          0.05s
  ⨯ it rejects invalid tracking numbers                                  0.04s
  ⨯ it can get shipping route                                            0.05s

   FAIL  Tests\Feature\ShippingTrackingFlowTest
  ⨯ it gets shipping tracking details                                    0.05s
  ✓ it updates shipping status through external api                      0.05s
  ⨯ it completes full shipping lifecycle                                 0.06s

   FAIL  Tests\Feature\ShoppingCartFlowTest
  ⨯ it completes cart operations flow                                    0.05s
  ⨯ it can checkout and convert to order                                 0.05s

   PASS  Tests\Feature\SimpleShippingTest
  ✓ it can create shipping record                                        0.04s
  ✓ it can update shipping status                                        0.04s

   PASS  Tests\Feature\SimplifiedFeedbackTest
  ✓ simplified feedback flow                                             0.05s

   PASS  Tests\Feature\UserNotificationTest
  ✓ it can create a notification                                         0.04s
  ✓ it creates notification when order status changes                    0.04s
  ✓ it creates notification when feedback is reviewed                    0.04s
  ✓ it creates notification when new message is received                 0.05s
  ✓ it creates notification when product price changes                   0.04s
  ✓ it creates notification when shipping status changes                 0.04s
  ✓ it creates notification when user receives rating                    0.04s
  ✓ it can mark notification as read                                     0.04s
  ✓ it can mark all notifications as read                                0.04s
  ✓ it can count unread notifications                                    0.04s
  ✓ it can delete a notification                                         0.04s
  ✓ it can test api endpoints                                            0.06s
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\AuthTest > it cannot login with invalid credentials
  Unable to find JSON:

[{
    "error": "Invalid credentials"
}]

within response JSON:

[{
    "error": "Credenciales inválidas"
}].


Failed asserting that an array has the subset Array &0 [
    'error' => 'Invalid credentials',
].
--- Expected
+++ Actual
@@ @@
 array (
-  'error' => 'Invalid credentials',
+  'error' => 'Credenciales inválidas',
 )

  at tests\Feature\AuthTest.php:57
     53▕             'password' => 'wrong-password',
     54▕         ]);
     55▕
     56▕         $response->assertStatus(401)
  ➜  57▕             ->assertJson([
     58▕                 'error' => 'Invalid credentials',
     59▕             ]);
     60▕     }
     61▕

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\AuthTest > it can refresh token
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

ErrorException: array_flip(): Can only flip string and integer values, entry skipped in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Arr.php:516
Stack trace:
#0 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php(256): Illuminate\Foundation\Bootstrap\HandleExceptions->handleError(2, 'array_flip(): C...', 'C:\\Users\\kevin\\...', 516)
#1 [internal function]: Illuminate\Foundation\Bootstrap\HandleExceptions->Illuminate\Foundation\Bootstrap\{closure}(2, 'array_flip(): C...', 'C:\\Users\\kevin\\...', 516)
#2 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Arr.php(516): array_flip(Array)
#3 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Collection.php(958): Illuminate\Support\Arr::only(Array, Array)
#4 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\Manager.php(168): Illuminate\Support\Collection->only(Array)
#5 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\Manager.php(124): Tymon\JWTAuth\Manager->buildRefreshClaims(Object(Tymon\JWTAuth\Payload))
#6 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\JWT.php(102): Tymon\JWTAuth\Manager->refresh(Object(Tymon\JWTAuth\Token), false, false)
#7 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Tymon\JWTAuth\JWT->refresh()
#8 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\app\Http\Controllers\AuthController.php(160): Illuminate\Support\Facades\Facade::__callStatic('refresh', Array)
#9 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Controller.php(54): App\Http\Controllers\AuthController->refresh()
#10 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(44): Illuminate\Routing\Controller->callAction('refresh', Array)
#11 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher->dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\AuthController), 'refresh')
#12 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route->runController()
#13 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(809): Illuminate\Routing\Route->run()
#14 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#15 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\app\Http\Middleware\JwtMiddleware.php(68): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#16 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\JwtMiddleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#21 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(787): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#22 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(751): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#23 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(740): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#24 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#25 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#26 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#27 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#28 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#31 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#38 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#39 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#40 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#41 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle(Object(Illuminate\Http\Request), Object(Closure))
#42 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#43 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePathEncoding->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#46 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#47 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#48 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase->call('POST', '/api/auth/refre...', Array, Array, Array, Array, '[]')
#49 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase->json('POST', '/api/auth/refre...', Array, Array, 0)
#50 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Feature\AuthTest.php(121): Illuminate\Foundation\Testing\TestCase->postJson('/api/auth/refre...')
#51 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(1240): Tests\Feature\AuthTest->it_can_refresh_token()
#52 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(514): PHPUnit\Framework\TestCase->runTest()
#53 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#54 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(361): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\AuthTest))
#55 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#56 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#57 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#58 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\TextUI\Application.php(210): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#59 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application->run(Array)
#60 {main}

----------------------------------------------------------------------------------

array_flip(): Can only flip string and integer values, entry skipped

  at tests\Feature\AuthTest.php:123
    119▕         $response = $this->withHeaders([
    120▕             'Authorization' => 'Bearer ' . $token,
    121▕         ])->postJson('/api/auth/refresh');
    122▕
  ➜ 123▕         $response->assertStatus(200)
    124▕             ->assertJsonStructure([
    125▕                 'access_token',
    126▕                 'token_type',
    127▕                 'expires_in',

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\AuthTest > it blocks access for blocked user
  Unable to find JSON:

[{
    "error": "Your account has been blocked"
}]

within response JSON:

[{
    "error": "Tu cuenta ha sido bloqueada"
}].


Failed asserting that an array has the subset Array &0 [
    'error' => 'Your account has been blocked',
].
--- Expected
+++ Actual
@@ @@
 array (
-  'error' => 'Your account has been blocked',
+  'error' => 'Tu cuenta ha sido bloqueada',
 )

  at tests\Feature\AuthTest.php:179
    175▕             'password' => 'password123',
    176▕         ]);
    177▕
    178▕         $response->assertStatus(403)
  ➜ 179▕             ->assertJson([
    180▕                 'error' => 'Your account has been blocked',
    181▕             ]);
    182▕     }
    183▕ }

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthControllerTest > user cannot login with in…
  Unable to find JSON:

[{
    "error": "Invalid credentials"
}]

within response JSON:

[{
    "error": "Credenciales inválidas"
}].


Failed asserting that an array has the subset Array &0 [
    'error' => 'Invalid credentials',
].
--- Expected
+++ Actual
@@ @@
 array (
-  'error' => 'Invalid credentials',
+  'error' => 'Credenciales inválidas',
 )

  at tests\Feature\Auth\AuthControllerTest.php:52
     48▕             'password' => 'wrong-password',
     49▕         ]);
     50▕
     51▕         $response->assertStatus(401);
  ➜  52▕         $response->assertJson(['error' => 'Invalid credentials']);
     53▕     }
     54▕
     55▕     #[Test]
     56▕     public function blocked_user_cannot_login()

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthControllerTest > blocked user cannot login
  Unable to find JSON:

[{
    "error": "Your account has been blocked"
}]

within response JSON:

[{
    "error": "Tu cuenta ha sido bloqueada"
}].


Failed asserting that an array has the subset Array &0 [
    'error' => 'Your account has been blocked',
].
--- Expected
+++ Actual
@@ @@
 array (
-  'error' => 'Your account has been blocked',
+  'error' => 'Tu cuenta ha sido bloqueada',
 )

  at tests\Feature\Auth\AuthControllerTest.php:69
     65▕             'password' => $password,
     66▕         ]);
     67▕
     68▕         $response->assertStatus(403);
  ➜  69▕         $response->assertJson(['error' => 'Your account has been blocked']);
     70▕     }
     71▕
     72▕     #[Test]
     73▕     public function authenticated_user_can_get_profile()

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthControllerTest > authenticated user can re…
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

ErrorException: array_flip(): Can only flip string and integer values, entry skipped in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Arr.php:516
Stack trace:
#0 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php(256): Illuminate\Foundation\Bootstrap\HandleExceptions->handleError(2, 'array_flip(): C...', 'C:\\Users\\kevin\\...', 516)
#1 [internal function]: Illuminate\Foundation\Bootstrap\HandleExceptions->Illuminate\Foundation\Bootstrap\{closure}(2, 'array_flip(): C...', 'C:\\Users\\kevin\\...', 516)
#2 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Arr.php(516): array_flip(Array)
#3 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Collection.php(958): Illuminate\Support\Arr::only(Array, Array)
#4 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\Manager.php(168): Illuminate\Support\Collection->only(Array)
#5 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\Manager.php(124): Tymon\JWTAuth\Manager->buildRefreshClaims(Object(Tymon\JWTAuth\Payload))
#6 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\JWT.php(102): Tymon\JWTAuth\Manager->refresh(Object(Tymon\JWTAuth\Token), false, false)
#7 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Tymon\JWTAuth\JWT->refresh()
#8 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\app\Http\Controllers\AuthController.php(160): Illuminate\Support\Facades\Facade::__callStatic('refresh', Array)
#9 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Controller.php(54): App\Http\Controllers\AuthController->refresh()
#10 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(44): Illuminate\Routing\Controller->callAction('refresh', Array)
#11 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher->dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\AuthController), 'refresh')
#12 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route->runController()
#13 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(809): Illuminate\Routing\Route->run()
#14 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#15 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\app\Http\Middleware\JwtMiddleware.php(68): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#16 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\JwtMiddleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#21 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(787): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#22 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(751): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#23 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(740): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#24 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#25 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#26 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#27 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#28 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#31 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#38 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#39 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#40 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#41 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle(Object(Illuminate\Http\Request), Object(Closure))
#42 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#43 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePathEncoding->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#46 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#47 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#48 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase->call('POST', '/api/auth/refre...', Array, Array, Array, Array, '[]')
#49 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase->json('POST', '/api/auth/refre...', Array, Array, 0)
#50 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Feature\Auth\AuthControllerTest.php(108): Illuminate\Foundation\Testing\TestCase->postJson('/api/auth/refre...')
#51 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(1240): Tests\Feature\Auth\AuthControllerTest->authenticated_user_can_refresh_token()
#52 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(514): PHPUnit\Framework\TestCase->runTest()
#53 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#54 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(361): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\Auth\AuthControllerTest))
#55 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#56 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#57 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#58 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\TextUI\Application.php(210): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#59 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application->run(Array)
#60 {main}

----------------------------------------------------------------------------------

array_flip(): Can only flip string and integer values, entry skipped

  at tests\Feature\Auth\AuthControllerTest.php:110
    106▕         $response = $this->withHeaders([
    107▕             'Authorization' => 'Bearer ' . $originalToken
    108▕         ])->postJson('/api/auth/refresh');
    109▕
  ➜ 110▕         $response->assertOk();
    111▕         $response->assertJsonStructure([
    112▕             'access_token',
    113▕             'token_type',
    114▕             'expires_in',

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can view their orders
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:95
     91▕             'Authorization' => 'Bearer ' . $this->sellerToken,
     92▕             'Accept' => 'application/json',
     93▕         ])->getJson('/api/seller/orders');
     94▕
  ➜  95▕         $response->assertStatus(200)
     96▕             ->assertJsonStructure([
     97▕                 'success',
     98▕                 'data',
     99▕                 'pagination' => [

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can filter orders by s…
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:123
    119▕             'Authorization' => 'Bearer ' . $this->sellerToken,
    120▕             'Accept' => 'application/json',
    121▕         ])->getJson('/api/seller/orders?status=pending');
    122▕
  ➜ 123▕         $response->assertStatus(200)
    124▕             ->assertJson([
    125▕                 'success' => true
    126▕             ]);
    127▕

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can update order statu…
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:147
    143▕         ])->patchJson('/api/seller/orders/' . $this->order->id . '/status', [
    144▕             'status' => 'processing'
    145▕         ]);
    146▕
  ➜ 147▕         $response->assertStatus(200)
    148▕             ->assertJson([
    149▕                 'success' => true,
    150▕                 'data' => [
    151▕                     'status' => 'processing'

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller cannot update another…
  Expected response status code [403] but received 404.
Failed asserting that 404 is identical to 403.

  at tests\Feature\OrderControllerTest.php:185
    181▕         ])->patchJson('/api/seller/orders/' . $anotherOrder->id . '/status', [
    182▕             'status' => 'processing'
    183▕         ]);
    184▕
  ➜ 185▕         $response->assertStatus(403)
    186▕             ->assertJson([
    187▕                 'success' => false
    188▕             ]);
    189▕     }

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can complete an order
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:204
    200▕             'Authorization' => 'Bearer ' . $this->sellerToken,
    201▕             'Accept' => 'application/json',
    202▕         ])->postJson('/api/seller/orders/' . $this->order->id . '/complete');
    203▕
  ➜ 204▕         $response->assertStatus(200)
    205▕             ->assertJson([
    206▕                 'success' => true
    207▕             ]);
    208▕

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can view order stats
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:244
    240▕             'Authorization' => 'Bearer ' . $this->sellerToken,
    241▕             'Accept' => 'application/json',
    242▕         ])->getJson('/api/seller/orders/stats');
    243▕
  ➜ 244▕         $response->assertStatus(200)
    245▕             ->assertJsonStructure([
    246▕                 'success',
    247▕                 'data' => [
    248▕                     'totalOrders',

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can update shipping in…
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:279
    275▕             'shipping_date' => now()->format('Y-m-d'),
    276▕             'estimated_delivery' => now()->addDays(3)->format('Y-m-d')
    277▕         ]);
    278▕
  ➜ 279▕         $response->assertStatus(200)
    280▕             ->assertJson([
    281▕                 'success' => true
    282▕             ]);
    283▕

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can cancel order
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:307
    303▕         ])->postJson('/api/seller/orders/' . $this->order->id . '/cancel', [
    304▕             'reason' => 'Producto no disponible'
    305▕         ]);
    306▕
  ➜ 307▕         $response->assertStatus(200)
    308▕             ->assertJson([
    309▕                 'success' => true
    310▕             ]);
    311▕

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > user cannot access seller end…
  Expected response status code [403] but received 404.
Failed asserting that 404 is identical to 403.

  at tests\Feature\OrderControllerTest.php:335
    331▕             'Accept' => 'application/json',
    332▕         ])->getJson('/api/seller/orders');
    333▕
    334▕         // Esperamos código 403 Forbidden o 401 Unauthorized dependiendo de tu implementación
  ➜ 335▕         $response->assertStatus(403);
    336▕     }
    337▕
    338▕     /** @test */
    339▕     public function seller_can_view_orders_awaiting_shipment()

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can view orders awaiti…
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:353
    349▕             'Authorization' => 'Bearer ' . $this->sellerToken,
    350▕             'Accept' => 'application/json',
    351▕         ])->getJson('/api/seller/orders/awaiting-shipment');
    352▕
  ➜ 353▕         $response->assertStatus(200)
    354▕             ->assertJsonStructure([
    355▕                 'success',
    356▕                 'data'
    357▕             ]);

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\OrderControllerTest > seller can view order details
  Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.

  at tests\Feature\OrderControllerTest.php:371
    367▕             'Authorization' => 'Bearer ' . $this->sellerToken,
    368▕             'Accept' => 'application/json',
    369▕         ])->getJson('/api/seller/orders/' . $this->order->id);
    370▕
  ➜ 371▕         $response->assertStatus(200)
    372▕             ->assertJsonStructure([
    373▕                 'success',
    374▕                 'data' => [
    375▕                     'id',

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProductRepositoryTest > it creates a pro…  TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #12 ($height) must be of type ?float, string given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Feature\ProductRepositoryTest.php on line 38

  at app\Domain\Entities\ProductEntity.php:38
     34▕     private ?string $shortDescription;
     35▕     private ?string $createdAt;
     36▕     private ?string $updatedAt;
     37▕
  ➜  38▕     public function __construct(
     39▕         int $userId,
     40▕         int $categoryId,
     41▕         string $name,
     42▕         string $slug,

  1   app\Domain\Entities\ProductEntity.php:38
  2   tests\Feature\ProductRepositoryTest.php:38

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProductSearchIntegrationTest > it tracks sea…  Error
  Call to undefined method Tests\Feature\ProductSearchIntegrationTest::addWarning()

  at tests\Feature\ProductSearchIntegrationTest.php:334
    330▕                 'user_id' => $this->user->id,
    331▕                 'interaction_type' => 'search',
    332▕             ]);
    333▕         } else {
  ➜ 334▕             $this->addWarning('Endpoint para rastreo de interacciones no encontrado o no funcional. Considerar implementarlo.');
    335▕         }
    336▕     }
    337▕
    338▕     #[Test]

  1   tests\Feature\ProductSearchIntegrationTest.php:334

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProductSearchIntegrationTest > it gets recom…  Error
  Call to undefined method Tests\Feature\ProductSearchIntegrationTest::addWarning()

  at tests\Feature\ProductSearchIntegrationTest.php:371
    367▕                 $recommendationsResponse->json('data'),
    368▕                 "El sistema de recomendaciones no devolvió productos."
    369▕             );
    370▕         } else {
  ➜ 371▕             $this->addWarning('Endpoint de recomendaciones no encontrado. Considerar implementarlo para complementar el sistema de búsqueda.');
    372▕         }
    373▕     }
    374▕
    375▕     /**

  1   tests\Feature\ProductSearchIntegrationTest.php:371

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\RatingSystemTest > it retrieves user given ratings
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\RatingSystemTest.php:511
    507▕         $response = $this->withHeaders([
    508▕             'Authorization' => 'Bearer ' . $this->buyerToken,
    509▕         ])->getJson('/api/ratings/my/given');
    510▕
  ➜ 511▕         $response->assertStatus(200)
    512▕             ->assertJsonCount(2, 'data');
    513▕     }
    514▕
    515▕     #[Test]

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\RecommendationSystemTest > it handles api calls for…
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\RecommendationSystemTest.php:242
    238▕             'Authorization' => 'Bearer ' . $this->token,
    239▕         ])->getJson('/api/recommendations?limit=5');
    240▕
    241▕         // Verificar respuesta exitosa
  ➜ 242▕         $response->assertStatus(200)
    243▕             ->assertJsonStructure([
    244▕                 'data' => [
    245▕                     '*' => [
    246▕                         'id',

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\RecommendationSystemTest > it tracks api interactio…
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\RecommendationSystemTest.php:269
    265▕             'metadata' => ['view_time' => 120]
    266▕         ]);
    267▕
    268▕         // Verificar respuesta exitosa
  ➜ 269▕         $response->assertStatus(200)
    270▕             ->assertJson(['success' => true]);
    271▕
    272▕         // Verificar que la interacción se guardó en la base de datos
    273▕         $this->assertDatabaseHas('user_interactions', [

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\RecommendationSystemTest > it retrieves user profil…
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\RecommendationSystemTest.php:297
    293▕             'Authorization' => 'Bearer ' . $this->token,
    294▕         ])->getJson('/api/recommendations/user-profile');
    295▕
    296▕         // Verificar respuesta exitosa
  ➜ 297▕         $response->assertStatus(200)
    298▕             ->assertJsonStructure([
    299▕                 'data' => [
    300▕                     'top_interests',
    301▕                     'recent_searches',

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShippingHistoryTest > it debugs shipping history en…
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\ShippingHistoryTest.php:121
    117▕         // Fetch shipping history via API
    118▕         $response = $this->withHeaders(['Authorization' => 'Bearer ' . $this->token])
    119▕             ->getJson('/api/shipping/' . $this->shipping->tracking_number . '/history');
    120▕
  ➜ 121▕         $response->assertStatus(200);
    122▕
    123▕         // Debug: Print out the API response
    124▕         Log::info(
    125▕             'Shipping History API Response:',

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShippingTrackerTest > it can get shipping tracking…
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\ShippingTrackerTest.php:80
     76▕                 'response' => $response->getContent()
     77▕             ]);
     78▕         }
     79▕
  ➜  80▕         $response->assertStatus(200);
     81▕         $response->assertJson([
     82▕             'status' => 'success',
     83▕             'data' => [
     84▕                 'tracking_number' => $this->shipping->tracking_number,

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShippingTrackerTest > it can get shipping history
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\ShippingTrackerTest.php:116
    112▕
    113▕         $response = $this->withHeaders(['Authorization' => 'Bearer ' . $this->token])
    114▕             ->getJson('/api/shipping/' . $this->shipping->tracking_number . '/history');
    115▕
  ➜ 116▕         $response->assertStatus(200);
    117▕         $response->assertJson([
    118▕             'status' => 'success',
    119▕             'data' => [
    120▕                 'tracking_number' => $this->shipping->tracking_number,

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShippingTrackerTest > it rejects invalid tracking n…
  Expected response status code [400] but received 403.
Failed asserting that 403 is identical to 400.

  at tests\Feature\ShippingTrackerTest.php:135
    131▕     {
    132▕         $response = $this->withHeaders(['Authorization' => 'Bearer ' . $this->token])
    133▕             ->getJson('/api/shipping/INVALID123');
    134▕
  ➜ 135▕         $response->assertStatus(400);
    136▕         $response->assertJson([
    137▕             'status' => 'error'
    138▕         ]);
    139▕     }

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShippingTrackerTest > it can get shipping route
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\ShippingTrackerTest.php:175
    171▕
    172▕         $response = $this->withHeaders(['Authorization' => 'Bearer ' . $this->token])
    173▕             ->getJson('/api/shipping/' . $this->shipping->tracking_number . '/route');
    174▕
  ➜ 175▕         $response->assertStatus(200);
    176▕         $response->assertJsonStructure([
    177▕             'status',
    178▕             'data' => [
    179▕                 'tracking_number',

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShippingTrackingFlowTest > it gets shipping trackin…
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\ShippingTrackingFlowTest.php:91
     87▕     {
     88▕         $response = $this->withHeaders(['Authorization' => 'Bearer ' . $this->token])
     89▕             ->getJson('/api/shipping/' . $this->shipping->tracking_number);
     90▕
  ➜  91▕         $response->assertStatus(200);
     92▕         $response->assertJson([
     93▕             'status' => 'success',
     94▕             'data' => [
     95▕                 'tracking_number' => $this->shipping->tracking_number,

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShippingTrackingFlowTest > it completes full shippi…
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\ShippingTrackingFlowTest.php:234
    230▕         // Verificar todo el historial de envío
    231▕         $response = $this->withHeaders(['Authorization' => 'Bearer ' . $this->token])
    232▕             ->getJson('/api/shipping/' . $this->shipping->tracking_number . '/history');
    233▕
  ➜ 234▕         $response->assertStatus(200);
    235▕         $response->assertJsonCount(4, 'data.history');
    236▕         $response->assertJsonPath('data.history.0.status', ShippingStatus::IN_TRANSIT);
    237▕         $response->assertJsonPath('data.history.1.status', ShippingStatus::IN_TRANSIT);
    238▕         $response->assertJsonPath('data.history.2.status', ShippingStatus::OUT_FOR_DELIVERY);

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShoppingCartFlowTest > it completes cart operations…
  Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.

  at tests\Feature\ShoppingCartFlowTest.php:99
     95▕     {
     96▕         // 1. Verificar que el carrito está vacío inicialmente
     97▕         $response = $this->makeRequest('get', '/api/cart');
     98▕
  ➜  99▕         $response->assertStatus(200);
    100▕         $response->assertJson([
    101▕             'status' => 'success',
    102▕             'data' => [
    103▕                 'total' => 0,

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ShoppingCartFlowTest > it can checkout and convert…
  Unable to find JSON:

[{
    "status": "success",
    "data": {
        "total": 400,
        "item_count": 2
    }
}]

within response JSON:

[{
    "status": "error",
    "message": "Forbidden: Seller privileges required"
}].


Failed asserting that an array has the subset Array &0 [
    'status' => 'success',
    'data' => Array &1 [
        'total' => 400,
        'item_count' => 2,
    ],
].
--- Expected
+++ Actual
@@ @@
 array (
-  'status' => 'success',
+  'status' => 'error',
   'message' => 'Forbidden: Seller privileges required',
-  'data' =>
-  array (
-    'total' => 400,
-    'item_count' => 2,
-  ),
 )

  at tests\Feature\ShoppingCartFlowTest.php:272
    268▕
    269▕         // 3. Verificar que el carrito tiene los productos correctos antes de checkout
    270▕         $responseCart = $this->makeRequest('get', '/api/cart');
    271▕
  ➜ 272▕         $responseCart->assertJson([
    273▕             'status' => 'success',
    274▕             'data' => [
    275▕                 'total' => 400, // 2*100 + 1*200
    276▕                 'item_count' => 2


  Tests:    33 failed, 141 passed (714 assertions)
  Duration: 10.82s

===============================================
⚠️ WARNING: El comando anterior falló con código de salida 2
Ejecutando prueba del repositorio de productos...
Ejecutando: php artisan test tests/Feature/ProductRepositoryTest.php

   FAIL  Tests\Feature\ProductRepositoryTest
  ⨯ it creates a product                                                 0.75s
  ✓ it finds product by id                                               0.04s
  ✓ it finds product by slug                                             0.04s
  ✓ it updates a product                                                 0.05s
  ✓ it deletes a product                                                 0.04s
  ✓ it finds products by category                                        0.04s
  ✓ it searches products                                                 0.04s
  ✓ it finds products by tags                                            0.04s
  ✓ it increments view count                                             0.04s
  ✓ it updates stock                                                     0.04s
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\ProductRepositoryTest > it creates a pro…  TypeError
  App\Domain\Entities\ProductEntity::__construct(): Argument #12 ($height) must be of type ?float, string given, called in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Feature\ProductRepositoryTest.php on line 38

  at app\Domain\Entities\ProductEntity.php:0
      1▕ <?php
      2▕
      3▕ namespace App\Domain\Entities;
      4▕
      5▕ class ProductEntity
      6▕ {
      7▕     private ?int $id;
      8▕     private int $userId;
      9▕     private int $categoryId;

  1   app\Domain\Entities\ProductEntity.php:0
  2   tests\Feature\ProductRepositoryTest.php:38


  Tests:    1 failed, 9 passed (28 assertions)
  Duration: 1.29s

===============================================
⚠️ WARNING: El comando anterior falló con código de salida 2
Ejecutando prueba del repositorio de chat...
Ejecutando: php artisan test tests/Feature/ChatRepositoryTest.php

   PASS  Tests\Feature\ChatRepositoryTest
  ✓ it creates a chat                                                    0.85s
  ✓ it adds a message to chat                                            0.04s
  ✓ it retrieves messages for chat                                       0.04s
  ✓ it marks messages as read                                            0.04s

  Tests:    4 passed (17 assertions)
  Duration: 1.14s

===============================================
Ejecutando pruebas de autenticación...
Ejecutando: php artisan test tests/Feature/Auth

   FAIL  Tests\Feature\Auth\AuthControllerTest
  ✓ user can login successfully                                          0.79s
  ⨯ user cannot login with invalid credentials                           0.06s
  ⨯ blocked user cannot login                                            0.04s
  ✓ authenticated user can get profile                                   0.04s
  ✓ authenticated user can logout                                        0.05s
  ⨯ authenticated user can refresh token                                 0.05s

   PASS  Tests\Feature\Auth\EmailVerificationTest
  ✓ email can be verified                                                0.04s
  ✓ email is not verified with invalid hash                              0.04s

   PASS  Tests\Feature\Auth\PasswordResetTest
  ✓ reset password link generates token                                  0.04s
  ✓ can reset password with valid token                                  0.04s
  ✓ cannot reset password with invalid token                             0.03s
  ✓ token validation works correctly                                     0.03s

   PASS  Tests\Feature\Auth\RegistrationTest
  ✓ new users can register                                               0.04s
  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthControllerTest > user cannot login with in…
  Unable to find JSON:

[{
    "error": "Invalid credentials"
}]

within response JSON:

[{
    "error": "Credenciales inválidas"
}].


Failed asserting that an array has the subset Array &0 [
    'error' => 'Invalid credentials',
].
--- Expected
+++ Actual
@@ @@
 array (
-  'error' => 'Invalid credentials',
+  'error' => 'Credenciales inválidas',
 )

  at tests\Feature\Auth\AuthControllerTest.php:52
     48▕             'password' => 'wrong-password',
     49▕         ]);
     50▕
     51▕         $response->assertStatus(401);
  ➜  52▕         $response->assertJson(['error' => 'Invalid credentials']);
     53▕     }
     54▕
     55▕     #[Test]
     56▕     public function blocked_user_cannot_login()

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthControllerTest > blocked user cannot login
  Unable to find JSON:

[{
    "error": "Your account has been blocked"
}]

within response JSON:

[{
    "error": "Tu cuenta ha sido bloqueada"
}].


Failed asserting that an array has the subset Array &0 [
    'error' => 'Your account has been blocked',
].
--- Expected
+++ Actual
@@ @@
 array (
-  'error' => 'Your account has been blocked',
+  'error' => 'Tu cuenta ha sido bloqueada',
 )

  at tests\Feature\Auth\AuthControllerTest.php:69
     65▕             'password' => $password,
     66▕         ]);
     67▕
     68▕         $response->assertStatus(403);
  ➜  69▕         $response->assertJson(['error' => 'Your account has been blocked']);
     70▕     }
     71▕
     72▕     #[Test]
     73▕     public function authenticated_user_can_get_profile()

  ────────────────────────────────────────────────────────────────────────────
   FAILED  Tests\Feature\Auth\AuthControllerTest > authenticated user can re…
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

ErrorException: array_flip(): Can only flip string and integer values, entry skipped in C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Arr.php:516
Stack trace:
#0 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php(256): Illuminate\Foundation\Bootstrap\HandleExceptions->handleError(2, 'array_flip(): C...', 'C:\\Users\\kevin\\...', 516)
#1 [internal function]: Illuminate\Foundation\Bootstrap\HandleExceptions->Illuminate\Foundation\Bootstrap\{closure}(2, 'array_flip(): C...', 'C:\\Users\\kevin\\...', 516)
#2 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Arr.php(516): array_flip(Array)
#3 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Collections\Collection.php(958): Illuminate\Support\Arr::only(Array, Array)
#4 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\Manager.php(168): Illuminate\Support\Collection->only(Array)
#5 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\Manager.php(124): Tymon\JWTAuth\Manager->buildRefreshClaims(Object(Tymon\JWTAuth\Payload))
#6 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\tymon\jwt-auth\src\JWT.php(102): Tymon\JWTAuth\Manager->refresh(Object(Tymon\JWTAuth\Token), false, false)
#7 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Tymon\JWTAuth\JWT->refresh()
#8 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\app\Http\Controllers\AuthController.php(160): Illuminate\Support\Facades\Facade::__callStatic('refresh', Array)
#9 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Controller.php(54): App\Http\Controllers\AuthController->refresh()
#10 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(44): Illuminate\Routing\Controller->callAction('refresh', Array)
#11 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher->dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\AuthController), 'refresh')
#12 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route->runController()
#13 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(809): Illuminate\Routing\Route->run()
#14 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#15 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\app\Http\Middleware\JwtMiddleware.php(68): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#16 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\JwtMiddleware->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#21 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(787): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#22 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(751): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#23 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Routing\Router.php(740): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#24 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#25 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#26 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#27 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#28 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#31 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#38 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#39 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#40 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#41 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle(Object(Illuminate\Http\Request), Object(Closure))
#42 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePathEncoding.php(26): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#43 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePathEncoding->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#46 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#47 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#48 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase->call('POST', '/api/auth/refre...', Array, Array, Array, Array, '[]')
#49 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase->json('POST', '/api/auth/refre...', Array, Array, 0)
#50 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\tests\Feature\Auth\AuthControllerTest.php(108): Illuminate\Foundation\Testing\TestCase->postJson('/api/auth/refre...')
#51 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(1240): Tests\Feature\Auth\AuthControllerTest->authenticated_user_can_refresh_token()
#52 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(514): PHPUnit\Framework\TestCase->runTest()
#53 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#54 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestCase.php(361): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\Auth\AuthControllerTest))
#55 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#56 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#57 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#58 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\src\TextUI\Application.php(210): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#59 C:\Users\kevin\OneDrive\Desktop\Proyecto de Programación\Proyectos Personales\webBCommerce\BCommerceBackEnd\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application->run(Array)
#60 {main}

----------------------------------------------------------------------------------

array_flip(): Can only flip string and integer values, entry skipped

  at tests\Feature\Auth\AuthControllerTest.php:110
    106▕         $response = $this->withHeaders([
    107▕             'Authorization' => 'Bearer ' . $originalToken
    108▕         ])->postJson('/api/auth/refresh');
    109▕
  ➜ 110▕         $response->assertOk();
    111▕         $response->assertJsonStructure([
    112▕             'access_token',
    113▕             'token_type',
    114▕             'expires_in',


  Tests:    3 failed, 10 passed (37 assertions)
  Duration: 1.50s

===============================================
⚠️ WARNING: El comando anterior falló con código de salida 1
Todas las pruebas han sido ejecutadas y los resultados se han guardado en test_results_20250412_173946.log
Para ver un informe detallado, ejecuta: php artisan test --coverage
